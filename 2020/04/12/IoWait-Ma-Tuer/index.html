<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>IoWait ma Tuer | n3ird4</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Cet article n’est pas de moi, je lui rend simplement hommage source  J’apprecie sons bon sens de l’hummour ainsi que sa logique dans la façon de procéder à l’analyse. voici donc son contenu:  Rien à p">
<meta name="keywords" content="iowait,vmstat,iotop">
<meta property="og:type" content="article">
<meta property="og:title" content="IoWait ma Tuer">
<meta property="og:url" content="http://91.208.181.214/2020/04/12/IoWait-Ma-Tuer/index.html">
<meta property="og:site_name" content="n3ird4">
<meta property="og:description" content="Cet article n’est pas de moi, je lui rend simplement hommage source  J’apprecie sons bon sens de l’hummour ainsi que sa logique dans la façon de procéder à l’analyse. voici donc son contenu:  Rien à p">
<meta property="og:locale" content="fr">
<meta property="og:updated_time" content="2020-04-12T17:49:05.642Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="IoWait ma Tuer">
<meta name="twitter:description" content="Cet article n’est pas de moi, je lui rend simplement hommage source  J’apprecie sons bon sens de l’hummour ainsi que sa logique dans la façon de procéder à l’analyse. voici donc son contenu:  Rien à p">
  
    <link rel="alternate" href="/atom.xml" title="n3ird4" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">n3ird4</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Just a blog about SysOps H4c|&lt; and Petanque...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://91.208.181.214"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-IoWait-Ma-Tuer" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/12/IoWait-Ma-Tuer/" class="article-date">
  <time datetime="2020-04-12T15:05:00.000Z" itemprop="datePublished">2020-04-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Sysadmin-Tips-Tricks/">Sysadmin Tips & Tricks</a>►<a class="article-category-link" href="/categories/Sysadmin-Tips-Tricks/iowait/">iowait</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      IoWait ma Tuer
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Cet article n’est pas de moi, je lui rend simplement hommage <a href="https://web.archive.org/web/20170917105833/http://blog.developpeur-neurasthenique.fr:80/auto-hebergement-iowait-ma-tuer-1-2-vmstat-mpstat-atop-pidstat.html" target="_blank" rel="noopener">source</a> </p>
<p>J’apprecie sons bon sens de l’hummour ainsi que sa logique dans la façon de procéder à l’analyse. voici donc son contenu: </p>
<p>Rien à péter, je suis passé au SSD… » (Bernard M., passionné par la fuite en avant)<br>IOwait : le mal aimé</p>
<p>« IOwait correspond au temps d’attente du système pour l’écriture ou la lecture de données. Un IOwait de 10 % signifie que 10 % de l’activité du CPU n’est pas destinée à faire des calculs mais à attendre l’exécution d’une opération de lecture/écriture. » (Wikipedia)</p>
<p>Pour afficher le pourcentage d’IOwait, c’est « vmstat » qui s’y colle :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vmstat 1</span></span><br><span class="line"></span><br><span class="line">procs  -----------memory---------- ---swap-- -----io---- -system-- ----cpu----  </span><br><span class="line">r  b   swpd   free   buff   cache   si   so    bi    bo   <span class="keyword">in</span>   cs  us sy id wa  </span><br><span class="line">1  0   7680  32200 353264 3111032    0    0 17173 19114  752  536   0  3 72 25  </span><br><span class="line">0  1   7680  31124 353376 3114680    0    0 12722 12798  799  569   0  3 75 22  </span><br><span class="line">0  1   7680  32916 353396 3114088    0    0  4592  4689  940  552   0  2 76 22  </span><br><span class="line">0  1   7680  33208 353432 3117292    0    0 20621 20533  739  592   0  4 77 19  </span><br><span class="line">1  1   7680  32096 353448 3119244    0    0 18426 18563  771  592   0  4 77 20</span><br></pre></td></tr></table></figure>
<p>La colonne qui nous intéresse est la dernière, celle qui se nomme « wa ». Plus cette valeur (en pourcentage) est élevée, plus le processeur se tourne les pouces parce que les disques durs sont littéralement à la bourre et n’arrivent pas à suivre la cadence.</p>
<p>Notez que, jusqu’ici tout va bien : « seulement » 20% d’IOwait (mais attendez un peu la suite).<br>IOwait le retour : petite tentative de démystification</p>
<p>La plupart du temps, quand on cherche rapidement des infos sur le sujet, on tombe surtout sur des personnes plus stressées les unes que les autres : « IOwait à 100%, suis-je maudis ? », « Trop d’IOwait, mon serveur rame à mort. » ou encore « J’ai un load average de fou à cause des IOwait, que faire ? ».</p>
<p>Ceci étant, pas de panique car pour réduire les IOwait, il suffit d’appliquer une des solutions suivantes :</p>
<ul>
<li>diminuer le nombre d’accès disque (Super, t’en as d’autres comme ça ?)</li>
<li>augmenter la charge du processeur (Gné ? Keskidi ?)</li>
<li>opter pour un processeur poussif (Chérie, fais gaffe, ce type est complètement con…)</li>
</ul>
<p>Et pourtant, je vous assure que ça marche : installez cpuburn sur un serveur saturé au niveau des IO, lancez autant de burns que le processeur a de coeurs et admirez le résultat.</p>
<p>Félicitations, les IOwait sont maintenant à 0%, n’hésitez pas à demander une augmentation à votre boss…<br>(Cependant, si le CPU crame à cause de vos conneries, ça va être une autre paire de manche)</p>
<p>J’en vois certains qui froncent les sourcils et c’est bien normal : le nombre d’accès disques n’a pas baissé d’un pouce (et le processeur est à bloc), alors c’est quoi l’embrouille ?</p>
<p>IOwait, la vengeance du come back : voyage au centre de la terre du kernel</p>
<p>Maintenant que l’on sait, au moins intuitivement, que l’indicateur d’IOwait est (plus ou moins) foireux, z’allions voir pourquoi.</p>
<p>L’aventure commence, comme d’hab, avec « /proc » :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /proc/stat</span></span><br><span class="line"></span><br><span class="line">cpu   14471379  41901343  7624436  1631039241  4181730  8954  254946  0  0  </span><br><span class="line">cpu0  2230907   8693273   1693928  409959262   1653894  1704  69221   0  0  </span><br><span class="line">cpu1  2183699   8699859   1554726  411272346   1392114  3277  69635   0  0  </span><br><span class="line">cpu2  4914950   12282210  2201785  405373432   646329   2223  62046   0  0  </span><br><span class="line">cpu3  5141820   12226000  2173996  404434200   489391   1749  54042   0  0  </span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<p>En fonction du noyau utilisé, le nombre de colonnes varie, « man 5 proc » est votre ami :</p>
<p><em>/proc/stat<br>kernel/system statistics. Varies with architecture. Common entries include:<br>cpu  3357 0 4313 1362393</em></p>
<p>_The amount of time, measured in units of USERi HZ (1/100ths of a second on most architectures, use sysconf(_SC__CLK__TCK_) to obtain the right value), that the system spent in user mode, user mode with low priority (nice), system mode, and the idle task, respectively. The last value should be USER_HZ_ times the second entry in the uptime pseudo-file_</p>
<p><em>In Linux 2.6 this line includes three additional columns: iowait – time waiting for I/O to complete (since 2.5.41); irq – time servicing interrupts (since 2.6.0-test4); softirq – time servicing softirqs (since 2.6.0-test4).</em></p>
<p><em>Since Linux 2.6.11, there is an eighth column, steal – stolen time, which is the time spent in other operating systems when running in a virtualized environment</em></p>
<p><em>Since Linux 2.6.24, there is a ninth column, guest, which is the time spent running a virtual CPU for guest operating systems under the control of the Linux kernel.</em></p>
<p>La nobox tournant avec une Debian Squeeze, la version du noyau est 2.6.32-41, le nombre de colonnes est donc égal à 9. Et si on veut savoir à quoi correspondent ces fameuses colonnes, suffit d’appeler Luke à la rescousse :</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 'kernel_stat.h' contains the definitions needed for doing</span></span><br><span class="line"><span class="comment"> * some kernel statistics (CPU usage, context switches ...),</span></span><br><span class="line"><span class="comment"> * used by rstatd/perfmeter</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> cpu_usage_stat &#123;  </span><br><span class="line">  <span class="keyword">cputime64_t</span> user;</span><br><span class="line">  <span class="keyword">cputime64_t</span> nice;</span><br><span class="line">  <span class="keyword">cputime64_t</span> system;</span><br><span class="line">  <span class="keyword">cputime64_t</span> softirq;</span><br><span class="line">  <span class="keyword">cputime64_t</span> irq;</span><br><span class="line">  <span class="keyword">cputime64_t</span> idle;</span><br><span class="line">  <span class="keyword">cputime64_t</span> iowait;</span><br><span class="line">  <span class="keyword">cputime64_t</span> steal;</span><br><span class="line">  <span class="keyword">cputime64_t</span> guest;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Bon, ok, vu du noyau, z’avions les différents « états » de chaque processeur.<br>Maintenant, ce qui nous intéresse, c’est de savoir comment iowait est incrémenté.</p>
<p>Et là, même punition, Luke s’y colle à nouveau:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Account for idle time.</span></span><br><span class="line"><span class="comment"> * @cputime: the cpu time spent in idle wait</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">account_idle_time</span><span class="params">(<span class="keyword">cputime_t</span> cputime)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">struct</span> cpu_usage_stat *cpustat = &amp;amp;kstat_this_cpu.cpustat;</span><br><span class="line">  <span class="keyword">cputime64_t</span> cputime64 = cputime_to_cputime64(cputime);</span><br><span class="line">  <span class="keyword">struct</span> rq *rq = this_rq();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (atomic_read(&amp;amp;rq-&amp;gt;nr_iowait) &amp;gt; <span class="number">0</span>)</span><br><span class="line">    cpustat-&amp;gt;iowait = cputime64_add(cpustat-&amp;gt;iowait, cputime64);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    cpustat-&amp;gt;idle = cputime64_add(cpustat-&amp;gt;idle, cputime64);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>En français dans le texte, ça nous donne ceci : si un CPU est « idle » (il n’a rien à faire) et qu’il y a des entrées/sorties en attente, alors le compteur « iowait » est incrémenté, sinon c’est le compteur « idle » qui est incrémenté.</p>
<p>Je vous la refais en plus clair : le compteur « iowait » ne peut être incrémenté que si le CPU est « idle ».</p>
<p>Nan, toujours pas ? Bon, ok : si un CPU est utilisé à 100%, il ne peut pas être « idle » donc l’iowait est forcément nul.</p>
<p>Ce qui nous amène aux conclusions suivantes :</p>
<ul>
<li>Plus le processeur utilisé est puissant, plus les IOwait seront élevés (à charge égale)</li>
<li>Un serveur « CPU bound » aura des IOwait très faibles même si les disques sont débordés</li>
<li>En résumé, l’indicateur IOwait ne permet pas de savoir à coup sûr si les disques limitent les performances</li>
</ul>
<p>Super, nous voilà bien avancé. Z’allions donc passer aux choses sérieuses.<br>IOwait, ze ultimate return même qu’il est pas content : mpstat</p>
<p>Sous Debian, mptstat fait partie du package sysstat : « apt-get install sysstat ».</p>
<p>Si vous vous souvenez du début de l’article, vous aurez constaté que la commande « vmstat » n’indiquait que 20% d’IOwait, pas de quoi fouetter un chat pourrait-on se dire.</p>
<p>Erreur… En fait, le système copiait un dossier vers un autre (« cp -a mon-gros-dossier copie-de-gros-dossier ») et, dans ce cas de figure, ce sont bien les disques qui ralentissent la copie. (On dit alors que le système est « IO bound » ).</p>
<p>Donc, même avec un tout petit processeur (Atom D525 1.8 Ghz : 2 coeurs + hyperthreading), il est nécessaire de surveiller à la loupe chaque coeur :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mpstat -P ALL 5</span></span><br><span class="line"></span><br><span class="line">Linux 2.6.32-5-amd64 (www.nobox.lan)       02/29/2012      _x86_64_        (4 CPU)</span><br><span class="line"></span><br><span class="line">02:02:04 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle  </span><br><span class="line">02:02:09 PM  all    0.10    0.00    2.62   21.19    0.10    0.30    0.00    0.00   75.70  </span><br><span class="line">02:02:09 PM    0    0.40    0.00    6.15   63.10    0.00    0.60    0.00    0.00   29.76  </span><br><span class="line">02:02:09 PM    1    0.00    0.00    0.20    0.98    0.20    0.00    0.00    0.00   98.63  </span><br><span class="line">02:02:09 PM    2    0.00    0.00    4.13   21.06    0.20    0.39    0.00    0.00   74.21  </span><br><span class="line">02:02:09 PM    3    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00</span><br><span class="line"></span><br><span class="line">02:02:09 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle  </span><br><span class="line">02:02:14 PM  all    2.23    0.00    2.67   23.32    0.20    0.35    0.00    0.00   71.24  </span><br><span class="line">02:02:14 PM    0    0.60    0.00    6.79   66.67    0.40    1.00    0.00    0.00   24.55  </span><br><span class="line">02:02:14 PM    1    8.12    0.00    0.59    0.00    0.20    0.00    0.00    0.00   91.09  </span><br><span class="line">02:02:14 PM    2    0.20    0.00    3.36   21.15    0.20    0.59    0.00    0.00   74.51  </span><br><span class="line">02:02:14 PM    3    0.00    0.00    0.00    5.88    0.00    0.00    0.00    0.00   94.12</span><br><span class="line"></span><br><span class="line">02:02:14 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle  </span><br><span class="line">02:02:19 PM  all    0.10    0.00    2.73   22.23    0.20    0.25    0.00    0.00   74.49  </span><br><span class="line">02:02:19 PM    0    0.20    0.00    7.36   63.02    0.20    0.99    0.00    0.00   28.23  </span><br><span class="line">02:02:19 PM    1    0.00    0.00    0.00    1.58    0.40    0.00    0.00    0.00   98.02  </span><br><span class="line">02:02:19 PM    2    0.20    0.00    3.74   24.21    0.20    0.20    0.00    0.00   71.46  </span><br><span class="line">02:02:19 PM    3    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00</span><br></pre></td></tr></table></figure>
<p>La seconde ligne (CPU all) de chaque bloc nous indique la moyenne des CPU (tout comme vmstat) mais on s’en contrefiche : regardez plutôt les IOwait de chaque coeur et en particulier celui du CPU 0.</p>
<p>Tout de suite c’est moins folichon : il n’y a qu’un seul coeur qui bosse vraiment(cf:1) et pas de chance, il passe plus de 60% de son temps à attendre que les IO en cours se terminent. Mais dormez tranquilles braves gens, l’IOwait moyen n’est que de 20%…</p>
<p>Formidable, tout ça c’est très joli sauf que, trop souvent, on ne sait pas à quelle sauce les disques durs sont mangés ni qui est le coupable : il est temps de passer à la chasse à l’homme.<br>IOwait, randonnée pour un tueur : iotop, atop et pidstat à la rescousse</p>
<p>Se promener dans les bois c’est bien, trouver une proie pour se faire un casse-croute aux fines herbes (et, soyons fou, avec un peu de mayo), c’est quand même mieux : « apt-get install iotop ».</p>
<p>Histoire d’avoir quelque chose à se mettre sous la prémolaire, pour changer, on va lancer une compilation du noyau (« make-kpkg –initrd kernel_image »)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># iotop -ako</span></span><br><span class="line"></span><br><span class="line">Total DISK READ: 0.00 K/s | Total DISK WRITE: 1272.82 K/s  </span><br><span class="line">TID   PRIO USER       DISK READ  DISK WRITE  SWAPIN     IO&amp;gt;   COMMAND  </span><br><span class="line">762   be/3 root          0.00 K    340.00 K  0.00 %  2.26 %   [jbd2/sda9-8]  </span><br><span class="line">777   be/3 root          0.00 K    160.00 K  0.00 %  0.97 %   [jbd2/sda7-8]  </span><br><span class="line">782   be/3 root          0.00 K    580.00 K  0.00 %  0.93 %   [jbd2/sda8-8]  </span><br><span class="line">772   be/3 root          0.00 K     44.00 K  0.00 %  0.30 %   [jbd2/sda6-8]  </span><br><span class="line">4918  be/4 postfix       4.00 K     24.00 K  0.00 %  0.04 %   cleanup -z -t unix -u -c  </span><br><span class="line">548   be/4 root          0.00 K    172.00 K  0.00 %  0.02 %   [flush-8:0]  </span><br><span class="line">7795  be/4 bdd-mysq      4.00 K     12.00 K  0.00 %  0.02 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">4919  be/4 postfix       8.00 K     52.00 K  0.00 %  0.02 %   virtual -t unix  </span><br><span class="line">7686  be/4 bdd-mysq      0.00 K     92.00 K  0.00 %  0.00 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">14190 be/4 mails         0.00 K     88.00 K  0.00 %  0.00 %   imap [xxxxxxxx@xxxxxxxxxx.fr xxx.xxx.xx.xxx]  </span><br><span class="line">12084 be/4 mails         0.00 K     40.00 K  0.00 %  0.00 %   imap [xxxxxxxx@xxxxxxxxxx.fr xxx.xxx.xx.xxx]  </span><br><span class="line">7679  be/4 bdd-mysq      0.00 K      4.00 K  0.00 %  0.00 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">4377  be/4 root          0.00 K     76.00 K  0.00 %  0.00 %   rsyslogd -c4  </span><br><span class="line">31337 be/4 bdd-mysq      0.00 K      0.00 K  0.00 %  0.00 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">25511 be/4 opendkim      0.00 K     28.00 K  0.00 %  0.00 %   opendkim -x /etc/opendkim.conf -u [...]  </span><br><span class="line">19797 be/4 root          0.00 K     12.00 K  0.00 %  0.00 %   vlogger (error <span class="built_in">log</span>)  </span><br><span class="line">19799 be/4 root          0.00 K     32.00 K  0.00 %  0.00 %   vlogger (access <span class="built_in">log</span>)  </span><br><span class="line">7681  be/4 bdd-mysq      0.00 K     80.00 K  0.00 %  0.00 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">7685  be/4 bdd-mysq      0.00 K      8.00 K  0.00 %  0.00 %   mysqld --basedir=/var/jail/ --datadir=[...]  </span><br><span class="line">7933  be/4 root          0.00 K      8.00 K  0.00 %  0.00 %   dovecot -c /etc/dovecot/dovecot.conf  </span><br><span class="line">12080 be/4 mails         0.00 K      4.00 K  0.00 %  0.00 %   imap [xxxxxg@xxxxxxxxx.fr xxx.xxx.xx.xxx]  </span><br><span class="line">24558 be/4 www-blog      0.00 K     12.00 K  0.00 %  0.00 %   php5-cgi  </span><br><span class="line">25512 be/4 opendkim      0.00 K      0.00 K  0.00 %  0.00 %   opendkim -x /etc/opendkim.conf -u [...]</span><br></pre></td></tr></table></figure>
<p>M’ouais… Je sais pas pour vous mais de mon côté, je ne vois rien d’excitant et encore moins les processus nécessaires à la compilation du noyau. Je n’ai pas creusé mais il semblerait qu’iotop n’affiche pas tous les processus effectuant des entrées/sorties. (Si quelqu’un a plus d’infos, je suis preneur !)</p>
<p>Pas grave, essayons autre chose : « apt-get install atop » :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># atop -c -d 5</span></span><br><span class="line"></span><br><span class="line">ATOP - www                2012/02/29  07:53:17                5 seconds elapsed  </span><br><span class="line">PRC | sys   0.33s | user   5.15s | <span class="comment">#proc    210 | #zombie    0 | #exit     48 |  </span></span><br><span class="line">CPU | sys     10% | user    104% | irq       1% | idle    284% | <span class="built_in">wait</span>      1% |  </span><br><span class="line">cpu | sys      6% | user     87% | irq       0% | idle      7% | cpu002 w  0% |  </span><br><span class="line">cpu | sys      2% | user      8% | irq       0% | idle     88% | cpu001 w  1% |  </span><br><span class="line">cpu | sys      1% | user      8% | irq       0% | idle     91% | cpu000 w  0% |  </span><br><span class="line">cpu | sys      1% | user      1% | irq       0% | idle     97% | cpu003 w  0% |  </span><br><span class="line">CPL | avg1   1.09 | avg5    1.38 | avg15   1.19 | csw     1216 | intr    3907 |  </span><br><span class="line">MEM | tot    3.9G | free  664.6M | cache   1.9G | buff  652.5M | slab  252.4M |  </span><br><span class="line">SWP | tot    4.0G | free    4.0G |              | vmcom   2.2G | vmlim   5.9G |  </span><br><span class="line">DSK |         sda | busy      2% | <span class="built_in">read</span>       9 | write     19 | avio    3 ms |  </span><br><span class="line">NET | transport   | tcpi     102 | tcpo     192 | udpi       0 | udpo       0 |  </span><br><span class="line">NET | network     | ipi      260 | ipo      350 | ipfrw    158 | deliv    102 |  </span><br><span class="line">NET | eth0     0% | pcki     264 | pcko     355 | si  244 Kbps | so  652 Kbps |  </span><br><span class="line">NET | ifb0   ---- | pcki     233 | pcko     233 | si  419 Kbps | so  419 Kbps |  </span><br><span class="line">NET | ifb2   ---- | pcki     121 | pcko     121 | si  230 Kbps | so  230 Kbps |</span><br><span class="line"></span><br><span class="line">PID  DSK COMMAND-LINE                                                  1/3  </span><br><span class="line">26991  96% /usr/bin/make <span class="_">-f</span> scripts/Makefile.build obj=arch/x86/kernel  </span><br><span class="line">12719   2% rsync --server --sender -vlogDtpre.iLsf --bwlimit=48 . /home/backup/  </span><br><span class="line">777     2% jbd2/sda7-8  </span><br><span class="line">762     0% jbd2/sda9-8  </span><br><span class="line">27030   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27044   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27058   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27072   0% /usr/lib/gcc/x86_64-linux-gnu/4.4.5/cc1 -quiet -nostdinc -Iinclude -  </span><br><span class="line">27036   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27050   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27035   0% &amp;lt;genksyms&amp;gt;  </span><br><span class="line">27064   0% &amp;lt;cc1&amp;gt;  </span><br><span class="line">27049   0% &amp;lt;genksyms&amp;gt;  </span><br><span class="line">27063   0% &amp;lt;genksyms&amp;gt;  </span><br><span class="line">27031   0% &amp;lt;as&amp;gt;  </span><br><span class="line">20630   0% atop <span class="_">-d</span> -c 5  </span><br><span class="line">27045   0% &amp;lt;as&amp;gt;  </span><br><span class="line">27059   0% &amp;lt;as&amp;gt;  </span><br><span class="line">12703   0% sshd: root@notty  </span><br><span class="line">27024   0% &amp;lt;as --gdwarf2 -Qy --64 -o arch/x86/kernel/entry_64.o /tmp/cc697jEh.&amp;gt;  </span><br><span class="line">27039   0% &amp;lt;fixdep&amp;gt;  </span><br><span class="line">27053   0% &amp;lt;fixdep&amp;gt;  </span><br><span class="line">27067   0% &amp;lt;fixdep&amp;gt;  </span><br><span class="line">21223   0% /usr/sbin/munin-node  </span><br><span class="line">27073   0% as -Qy --64 -o arch/x86/kernel/.tmp_dumpstack_64.o -  </span><br><span class="line">3721    0% imap-login</span><br></pre></td></tr></table></figure>
<p>Ha, enfin ! Notre grand gagnant de la semaine est le processus 26991. Zoomons un peu sur ce mécréant :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pidstat -d -p 26991 5</span></span><br><span class="line"></span><br><span class="line">Linux 2.6.32-5-amd64 (www.nobox.lan)       02/29/2012      _x86_64_        (4 CPU)</span><br><span class="line"></span><br><span class="line">07:54:42 AM       PID   kB_rd/s   kB_wr/s kB_ccwr/s  Command  </span><br><span class="line">07:54:47 AM     26991      0.00    315.20    132.80  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:54:52 AM     26991      0.00    197.60     44.80  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:54:57 AM     26991      0.00    185.60     50.40  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:55:02 AM     26991      0.00    251.20     85.60  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:55:07 AM     26991      0.00    204.80     68.00  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:55:12 AM     26991      0.00    109.60      8.80  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]  </span><br><span class="line">07:55:17 AM     26991      0.00    132.80      8.00  /usr/bin/make <span class="_">-f</span> scripts/Makefile.build [...]</span><br></pre></td></tr></table></figure>
<p>Voilà, fin de l’histoire : on apprend que « make » se promène tranquillement (dans les bois) tout en écrivant environ 200 Ko/s.</p>
<p>Ceci étant, au lieu de surveiller un seul processus, on peut aussi demander à voir l’activité globale avec « pidstat -d -l 5 » :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pidstat -d -l 5</span></span><br><span class="line"></span><br><span class="line">08:13:26 AM       PID   kB_rd/s   kB_wr/s kB_ccwr/s  Command  </span><br><span class="line">08:13:31 AM       762      0.00     24.51      0.00  jbd2/sda9-8  </span><br><span class="line">08:13:31 AM       782      0.00      0.79      0.00  jbd2/sda8-8  </span><br><span class="line">08:13:31 AM     19222  13796.84  14118.58      0.00  cp <span class="_">-a</span> gros-backup copie-de-gros-backup</span><br><span class="line"></span><br><span class="line">08:13:31 AM       PID   kB_rd/s   kB_wr/s kB_ccwr/s  Command  </span><br><span class="line">08:13:36 AM       762      0.00     15.20      0.00  jbd2/sda9-8  </span><br><span class="line">08:13:36 AM      1038      0.00      1.60      0.00  /usr/sbin/rsyslogd -c4  </span><br><span class="line">08:13:36 AM      5780      0.00      0.80      0.00  /usr/sbin/nmbd -D  </span><br><span class="line">08:13:36 AM     16095     32.80     20.80      0.80  /usr/lib/postfix/master  </span><br><span class="line">08:13:36 AM     19222  19984.00  19984.00      0.00  cp <span class="_">-a</span> gros-backup copie-de-gros-backup</span><br><span class="line"></span><br><span class="line">08:13:36 AM       PID   kB_rd/s   kB_wr/s kB_ccwr/s  Command  </span><br><span class="line">08:13:41 AM       762      0.00     13.60      0.00  jbd2/sda9-8  </span><br><span class="line">08:13:41 AM       782      0.00      3.20      0.00  jbd2/sda8-8  </span><br><span class="line">08:13:41 AM     16095      2.40      0.00      0.00  /usr/lib/postfix/master  </span><br><span class="line">08:13:41 AM     19222   8874.40   8993.60      0.00  cp <span class="_">-a</span> gros-backup copie-de-gros-backup</span><br></pre></td></tr></table></figure>
<p>Pour ceux qui viennent juste de comprendre, oui, depuis le début du billet et mis à part la compilation du kernel, tous les exemples sont basés sur « cp -a gros-backup copie-de-gros-backup » (mais, dans la seconde partie, on va varier les plaisirs car sinon c’est pas drôle).<br>The end ?</p>
<p>Non, suite au prochain numéro : il sera question d’IOPS, d’iostat et de plus si affinités…</p>
<p>A+</p>
<p> (1)   ainsi que le CPU 2 mais, sauf erreur, il s’agit du même coeur (Hyperthreading) ↩</p>
<p>Date de prescription :     29 février 2012<br>Effets secondaires :     Auto-hébergement<br>Médecin traitant :     tranxene50  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://91.208.181.214/2020/04/12/IoWait-Ma-Tuer/" data-id="ckhw57wed0037xhiyoc9mcp0t" class="article-share-link">Partager</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iotop/">iotop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iowait/">iowait</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmstat/">vmstat</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/04/26/Elastic-Stack-Essentials/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Récent</strong>
      <div class="article-nav-title">
        
          Elastic-Stack-Essentials
        
      </div>
    </a>
  
  
    <a href="/2020/04/11/swap/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ancien</strong>
      <div class="article-nav-title">Swap &amp; CO</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Catégories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AWS/">AWS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AWS/AWS-Certified-Solutions-Architect-Associate-SAA-C02/">AWS Certified Solutions Architect Associate SAA-C02</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ansible/">Ansible</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ansible/Quick-Starts/">Quick Starts</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/TryHackMe-Madness/">TryHackMe Madness</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/TryHackMe-Wgel/">TryHackMe Wgel</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/ElasticSearch/">ElasticSearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ElasticSearch/Playing-with-Elastic-Stack-Modules/">Playing with Elastic Stack Modules</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Git/Source-Control-with-Git/">Source Control with Git</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/How-to/">How to</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/Reparation-de-replication-master-master-sans-lock/">Réparation de réplication master/master (sans lock)</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/Playing-with-Nginx-and-Dynamic-Modules/">Playing with Nginx and Dynamic Modules</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sysadmin-Tips-Tricks/">Sysadmin Tips & Tricks</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Sysadmin-Tips-Tricks/iowait/">iowait</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sysadmin-Tips-Tricks/swap/">swap</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Varnish/">Varnish</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Varnish/blocklist-IP-address-with-Varnish/">blocklist IP address with Varnish</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/others/">others</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Mot-clés</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/42/">42</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS/">AWS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ansible/">Ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blog/">Blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ModSecurity/">ModSecurity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/">Test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Univers/">Univers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/githooks/">githooks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grep/">grep</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iotop/">iotop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iowait/">iowait</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/">sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/swap/">swap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tryhackme/">tryhackme</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/varnish/">varnish</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmstat/">vmstat</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Nuage de mot-clés</h3>
    <div class="widget tagcloud">
      <a href="/tags/42/" style="font-size: 10px;">42</a> <a href="/tags/AWS/" style="font-size: 10px;">AWS</a> <a href="/tags/Ansible/" style="font-size: 10px;">Ansible</a> <a href="/tags/Blog/" style="font-size: 20px;">Blog</a> <a href="/tags/ModSecurity/" style="font-size: 10px;">ModSecurity</a> <a href="/tags/Test/" style="font-size: 20px;">Test</a> <a href="/tags/Univers/" style="font-size: 10px;">Univers</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/githooks/" style="font-size: 10px;">githooks</a> <a href="/tags/grep/" style="font-size: 10px;">grep</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/iotop/" style="font-size: 10px;">iotop</a> <a href="/tags/iowait/" style="font-size: 10px;">iowait</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/sort/" style="font-size: 10px;">sort</a> <a href="/tags/swap/" style="font-size: 10px;">swap</a> <a href="/tags/tryhackme/" style="font-size: 15px;">tryhackme</a> <a href="/tags/varnish/" style="font-size: 10px;">varnish</a> <a href="/tags/vmstat/" style="font-size: 10px;">vmstat</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">novembre 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">octobre 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">septembre 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">juillet 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">mai 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">avril 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">octobre 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">décembre 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">avril 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">mars 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/24/Source-Control-with-Git/">Source Control with Git</a>
          </li>
        
          <li>
            <a href="/2020/10/27/TryHackMe-Madness-CTF-Write-Up/">TryHackMe Madness CTF Writeup</a>
          </li>
        
          <li>
            <a href="/2020/09/27/TryHackMe-Wgel-CTF-Write-Up/">TryHackMe Wgel CTF Writeup</a>
          </li>
        
          <li>
            <a href="/2020/09/08/AWS-SAAC-02/">AWS-SAAC-02</a>
          </li>
        
          <li>
            <a href="/2020/09/01/blocklist-IP-address-with-Varnish/">blocklist IP address with Varnish</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 n3ird4<br>
      Propulsé par <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/" target="_blank">Github</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>




  </div>
</body>
</html>